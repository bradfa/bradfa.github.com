---
layout: post
title: What's Going On in CLFS Chapter 5? [/tools and /cross-tools]
date: 2010-11-09
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
In building the CLFS PowerPC cross compiler the instructions say to create both the /tools and /cross-tools directories (these are actually symlinks to directories of your choosing but it's the easiest way to reference what I'm talking about).&nbsp; I didn't fully understand why this is the case so I did some Googling and re-read parts of the CLFS book.<br /><br />Turns out it's briefly described across various sections, including: <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/final-preps/creatingtoolsdir.html">4.2 (Creating the /tools Directory)</a>, <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/final-preps/creatingcrossdir.html">4.3 (Creating the /cross-tools Directory)</a>, <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/linux-headers.html">5.4 (Linux-Headers)</a>, and <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/temp-system/introduction.html">6.1 (Introduction to chapter 6)</a>.<br /><br />The /cross-tools directory is where the actual cross compiler and its assorted "friends" will live.&nbsp; The /tools directory is where we're building a temporary system that can actually build a real system.&nbsp; The entire goal of chapter 5 is to build a GCC cross compiler that executes on your desktop PC and builds executables for some other computer system (in my case, my desktop's an x86_64 box running Debian Lenny and I'm wanting to create executables for PowerPC Linux).<br /><br />A fun problem is that in order to build a cross compiler, we need a compiler (and a bunch of other stuff).&nbsp; There may be a shorter method to achieving this, but I outline the CLFS way of doing things:<br /><ul><li>Starting off with section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/linux-headers.html">5.4 (Linux Headers)</a>, just the header files for a Linux kernel are installed into /tools/include.&nbsp; The headers will be needed later to build Glibc.&nbsp;&nbsp;&nbsp;</li><li>In section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/file.html">5.5 (File)</a>, we build and install File into /cross-tools (File lets us figure out what type any given file is).&nbsp; This version of File we build is a native application on our desktop PC and is used by other steps.</li><li>Section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/binutils.html">5.6 (Cross Binutils)</a> has us build a set of binutils, again these are native to our desktop PC.&nbsp; No cross compiling yet.&nbsp; Binutils assists in compiling and linking programs.&nbsp; We'll use this set of binutils to build our cross compiler, GCC.&nbsp; Binutils gets installed into /cross-tools.</li><li>Now we get to some compiler compiling, section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/gcc-static.html">5.7 (Cross GCC - Static)</a>.&nbsp; Here we build a very simple, statically linked version (it includes all libraries it needs internally to itself rather than reference them being installed in another location) of GCC that can only compile C programs.&nbsp; GCC is actually built without any C library (Glibc) as we don't yet have it.&nbsp; GCC goes into /cross-tools.</li><li>Section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/glibc.html">5.8 (Glibc)</a> finally gets us to the C library.&nbsp; When configuring Glibc, we must tell the configuration script how to find all the different items we've already installed, as they're in non-standard locations.&nbsp; Glibc gets built using our statically linked GCC and our kernel headers, it has just enough ability to do so, and installed into the /tools directory.&nbsp; The kernel headers are needed as some of the implementation of the C library involves making system calls, thus the C library needs to know how to make those system calls.</li><li>Now we can finally create an actual cross compiler.&nbsp; Section <a href="http://cross-lfs.org/files/BOOK/1.1.0/view/ppc/cross-tools/gcc-final.html">5.9 (Cross GCC - Final) </a>finally has us build a real C and C++ cross compiler.&nbsp; This step uses the previously built statically linked GCC and Glibc to create a real, dynamically linked, version of GCC.&nbsp; Now we have a cross compiler!</li></ul><br />I'm curious to see how much of what was used to build our cross compiler is still needed in order to complete the CLFS book.&nbsp; Maybe this is a job for git (another thing I'd like to learn).</div>
<h2>Comments</h2>
<div class='comments'>
</div>
